<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guitar Chord Fingering Generator</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .form-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
            font-size: 1.1em;
        }

        input, select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #fafbfc;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .chord-input {
            font-family: 'Courier New', monospace;
            font-size: 18px;
            font-weight: bold;
        }

        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .clear-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
        }

        .clear-btn:hover {
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
        }

        .output {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-top: 25px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .output:empty {
            display: none;
        }

        .chord-diagrams {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .chord-diagram {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .chord-diagram svg {
            max-width: 100%;
            height: auto;
        }

        .chord-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }

        .help-text {
            background: #e8f4fd;
            color: #0369a1;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            border-left: 4px solid #0ea5e9;
        }

        .note-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .note-btn {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
            padding: 10px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.2s ease;
        }

        .note-btn:hover {
            background: #667eea;
            color: white;
            transform: translateY(-1px);
        }

        .advanced-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .error-message {
            background: #fee;
            border: 1px solid #fcc;
            color: #c33;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
            
            .advanced-options {
                grid-template-columns: 1fr;
            }

            .chord-diagrams {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé∏ Guitar Chord Generator</h1>
        
        <div class="form-section">
            <div class="form-group">
                <label for="chordInput">Enter chord notes (e.g., C E G, F# A# C#):</label>
                <input type="text" id="chordInput" class="chord-input" placeholder="C E G" autocomplete="off">
                
                <div class="note-buttons">
                    <button type="button" class="note-btn" onclick="addNote('C')">C</button>
                    <button type="button" class="note-btn" onclick="addNote('C#')">C#</button>
                    <button type="button" class="note-btn" onclick="addNote('D')">D</button>
                    <button type="button" class="note-btn" onclick="addNote('D#')">D#</button>
                    <button type="button" class="note-btn" onclick="addNote('E')">E</button>
                    <button type="button" class="note-btn" onclick="addNote('F')">F</button>
                    <button type="button" class="note-btn" onclick="addNote('F#')">F#</button>
                    <button type="button" class="note-btn" onclick="addNote('G')">G</button>
                    <button type="button" class="note-btn" onclick="addNote('G#')">G#</button>
                    <button type="button" class="note-btn" onclick="addNote('A')">A</button>
                    <button type="button" class="note-btn" onclick="addNote('A#')">A#</button>
                    <button type="button" class="note-btn" onclick="addNote('B')">B</button>
                </div>
            </div>

            <div class="advanced-options">
                <div class="form-group">
                    <label for="firstFret">Starting Fret:</label>
                    <select id="firstFret">
                        <option value="0">Open (0)</option>
                        <option value="1" selected>1st Fret</option>
                        <option value="3">3rd Fret</option>
                        <option value="5">5th Fret</option>
                        <option value="7">7th Fret</option>
                        <option value="9">9th Fret</option>
                        <option value="12">12th Fret</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="fretRange">Fret Range:</label>
                    <select id="fretRange">
                        <option value="3">3 Frets</option>
                        <option value="4" selected>4 Frets</option>
                        <option value="5">5 Frets</option>
                        <option value="6">6 Frets</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="rootNote">Root Note (optional):</label>
                    <select id="rootNote">
                        <option value="">Auto (first note)</option>
                        <option value="C">C</option>
                        <option value="C#">C# / Db</option>
                        <option value="D">D</option>
                        <option value="D#">D# / Eb</option>
                        <option value="E">E</option>
                        <option value="F">F</option>
                        <option value="F#">F# / Gb</option>
                        <option value="G">G</option>
                        <option value="G#">G# / Ab</option>
                        <option value="A">A</option>
                        <option value="A#">A# / Bb</option>
                        <option value="B">B</option>
                    </select>
                </div>
            </div>

            <div class="button-group">
                <button onclick="generateChord()">üéµ Generate Chord Fingerings</button>
                <button class="clear-btn" onclick="clearAll()">üóëÔ∏è Clear All</button>
            </div>

            <div class="help-text">
                üí° <strong>Tips:</strong> Enter notes separated by spaces. Use # for sharps (C# D# F#) or b for flats (Db Eb Gb). 
                Click the note buttons above to build your chord easily!
            </div>
        </div>

        <div id="output" class="output"></div>
    </div>

    <script>
        // Constants
        const MAX_NOTES = 65;
        const MAX_PATTERNS = 100;
        const MAX_STRINGS = 6;
        const MAX_FRETS = 26;

        // Note constants
        const _C = 0, _Db = 1, _D = 2, _Eb = 3, _E = 4, _F = 5;
        const _Gb = 6, _G = 7, _Ab = 8, _A = 9, _Bb = 10, _B = 11;
        const N_NOTES_IN_SCALE = 12;

        // String indices
        const LOW_E = 0, A_STRING = 1, D_STRING = 2;
        const G_STRING = 3, B_STRING = 4, HIGH_E = 5;

        // Default tuning (EADGBE)
        const DEFAULT_TUNING = [_E, _A, _D, _G, _B, _E];

        // Global variables
        let fretNotes = Array.from({ length: MAX_FRETS }, () => Array(MAX_STRINGS).fill(0));

        // Enhanced SVG Renderer Class from main.js
        class GuitarSVGRenderer {
            constructor() {
                this.svgNS = "http://www.w3.org/2000/svg";
                this.defaultConfig = {
                    width: 320,
                    stringCount: 6,
                    stringSpacing: 40,
                    fretSpacing: 35,
                    margin: 25,
                    circleRadius: 10,
                    fontSize: {
                        fretNumber: 12,
                        chordLabel: 11,
                        title: 14,
                        fingerNumber: 10
                    },
                    colors: {
                        fretLine: "#333",
                        stringLine: "#666",
                        rootNote: "#ff4444",
                        normalNote: "#4444ff",
                        rootText: "#fff",
                        normalText: "#fff",
                        openString: "#00aa00",
                        mutedString: "#aa0000",
                        fretNumber: "#666"
                    }
                };
            }

            createChordSVG(fingering, chordName, firstFret, fretRange) {
                const cfg = this.defaultConfig;
                const svg = document.createElementNS(this.svgNS, "svg");
                
                const fretCount = fretRange;
                const topPadding = 50;
                const baseHeight = cfg.margin * 2 + (fretCount * cfg.fretSpacing);
                const titleHeight = 40;
                const fingeringHeight = 30;
                const totalHeight = topPadding + baseHeight + titleHeight + fingeringHeight;
                
                svg.setAttribute("width", cfg.width);
                svg.setAttribute("height", totalHeight);
                
                this.drawFrets(svg, cfg, fretCount, firstFret, topPadding);
                this.drawStrings(svg, cfg, fretCount, topPadding);
                this.drawFingering(svg, cfg, fingering, firstFret, fretRange, topPadding);
                this.drawTitle(svg, cfg, chordName, topPadding + baseHeight + 25);
                this.drawFingeringText(svg, cfg, fingering, topPadding + baseHeight + titleHeight + 20);
                
                return svg;
            }

            drawFrets(svg, cfg, fretCount, firstFret, topPadding) {
                for (let i = 0; i <= fretCount; i++) {
                    const y = topPadding + cfg.margin + i * cfg.fretSpacing;
                    const line = document.createElementNS(this.svgNS, "line");
                    line.setAttribute("x1", cfg.margin);
                    line.setAttribute("x2", cfg.margin + (cfg.stringCount - 1) * cfg.stringSpacing);
                    line.setAttribute("y1", y);
                    line.setAttribute("y2", y);
                    line.setAttribute("stroke", cfg.colors.fretLine);
                    line.setAttribute("stroke-width", i === 0 ? "3" : "2");
                    svg.appendChild(line);
                    
                    // Add fret numbers
                    if (i === 0 && firstFret > 0) {
                        const text = document.createElementNS(this.svgNS, "text");
                        text.setAttribute("x", cfg.margin - 20);
                        text.setAttribute("y", y + cfg.fretSpacing/2 + 5);
                        text.setAttribute("font-size", cfg.fontSize.fretNumber);
                        text.setAttribute("text-anchor", "middle");
                        text.setAttribute("fill", cfg.colors.fretNumber);
                        text.textContent = firstFret;
                        svg.appendChild(text);
                    }
                }
            }

            drawStrings(svg, cfg, fretCount, topPadding) {
                for (let i = 0; i < cfg.stringCount; i++) {
                    const x = cfg.margin + i * cfg.stringSpacing;
                    const line = document.createElementNS(this.svgNS, "line");
                    line.setAttribute("x1", x);
                    line.setAttribute("x2", x);
                    line.setAttribute("y1", topPadding + cfg.margin);
                    line.setAttribute("y2", topPadding + cfg.margin + fretCount * cfg.fretSpacing);
                    line.setAttribute("stroke", cfg.colors.stringLine);
                    line.setAttribute("stroke-width", "2");
                    svg.appendChild(line);
                }
            }

            drawFingering(svg, cfg, fingering, firstFret, fretRange, topPadding) {
                for (let string = 0; string < MAX_STRINGS; string++) {
                    const fret = fingering[string];
                    const x = cfg.margin + string * cfg.stringSpacing;
                    
                    if (fret === -1) {
                        // Muted string
                        this.drawX(svg, x, topPadding + cfg.margin - 25, cfg.colors.mutedString);
                    } else if (fret === 0 && firstFret === 0) {
                        // Open string
                        this.drawO(svg, x, topPadding + cfg.margin - 25, cfg.colors.openString);
                    } else if (fret > 0) {
                        // Fretted note
                        const fretPosition = fret - firstFret + 1;
                        if (fretPosition > 0 && fretPosition <= fretRange) {
                            const y = topPadding + cfg.margin + fretPosition * cfg.fretSpacing - cfg.fretSpacing / 2;
                            const isRoot = this.isRootNote(fingering, string, fret);
                            
                            const circle = document.createElementNS(this.svgNS, "circle");
                            circle.setAttribute("cx", x);
                            circle.setAttribute("cy", y);
                            circle.setAttribute("r", cfg.circleRadius);
                            circle.setAttribute("fill", isRoot ? cfg.colors.rootNote : cfg.colors.normalNote);
                            circle.setAttribute("stroke", "#fff");
                            circle.setAttribute("stroke-width", "2");
                            svg.appendChild(circle);
                            
                            // Add finger number
                            const fingerNum = this.getFingerNumber(fingering, string, firstFret);
                            if (fingerNum) {
                                const text = document.createElementNS(this.svgNS, "text");
                                text.setAttribute("x", x);
                                text.setAttribute("y", y + 4);
                                text.setAttribute("font-size", cfg.fontSize.fingerNumber);
                                text.setAttribute("text-anchor", "middle");
                                text.setAttribute("fill", cfg.colors.normalText);
                                text.setAttribute("font-weight", "bold");
                                text.textContent = fingerNum;
                                svg.appendChild(text);
                            }
                        }
                    }
                }
            }

            drawX(svg, x, y, color) {
                const size = 8;
                const line1 = document.createElementNS(this.svgNS, "line");
                line1.setAttribute("x1", x - size);
                line1.setAttribute("y1", y - size);
                line1.setAttribute("x2", x + size);
                line1.setAttribute("y2", y + size);
                line1.setAttribute("stroke", color);
                line1.setAttribute("stroke-width", "3");
                line1.setAttribute("stroke-linecap", "round");
                svg.appendChild(line1);
                
                const line2 = document.createElementNS(this.svgNS, "line");
                line2.setAttribute("x1", x - size);
                line2.setAttribute("y1", y + size);
                line2.setAttribute("x2", x + size);
                line2.setAttribute("y2", y - size);
                line2.setAttribute("stroke", color);
                line2.setAttribute("stroke-width", "3");
                line2.setAttribute("stroke-linecap", "round");
                svg.appendChild(line2);
            }

            drawO(svg, x, y, color) {
                const circle = document.createElementNS(this.svgNS, "circle");
                circle.setAttribute("cx", x);
                circle.setAttribute("cy", y);
                circle.setAttribute("r", "8");
                circle.setAttribute("fill", "none");
                circle.setAttribute("stroke", color);
                circle.setAttribute("stroke-width", "3");
                svg.appendChild(circle);
            }

            drawTitle(svg, cfg, title, y) {
                const text = document.createElementNS(this.svgNS, "text");
                text.setAttribute("x", cfg.width / 2);
                text.setAttribute("y", y);
                text.setAttribute("font-size", cfg.fontSize.title);
                text.setAttribute("text-anchor", "middle");
                text.setAttribute("font-weight", "bold");
                text.setAttribute("fill", "#333");
                text.textContent = title;
                svg.appendChild(text);
            }

            drawFingeringText(svg, cfg, fingering, y) {
                const text = document.createElementNS(this.svgNS, "text");
                text.setAttribute("x", cfg.width / 2);
                text.setAttribute("y", y);
                text.setAttribute("font-size", 11);
                text.setAttribute("text-anchor", "middle");
                text.setAttribute("fill", "#666");
                text.setAttribute("font-family", "monospace");
                
                const fretText = fingering.map(fret => {
                    if (fret === -1) return 'X';
                    if (fret === 0) return '0';
                    return fret.toString();
                }).join(' - ');
                text.textContent = `Frets: ${fretText}`;
                svg.appendChild(text);
            }

            isRootNote(fingering, currentString, currentFret) {
                // Simple heuristic: lowest fret on bass strings is likely root
                const bassFrets = fingering.slice(0, 3).filter(f => f > 0);
                if (bassFrets.length === 0) return false;
                const lowestBassFret = Math.min(...bassFrets);
                return currentString <= 2 && currentFret === lowestBassFret;
            }

            getFingerNumber(fingering, currentString, firstFret) {
                const fret = fingering[currentString];
                if (fret <= 0) return '';
                
                // Get unique frets and sort them
                const usedFrets = [...new Set(fingering.filter(f => f > 0))].sort((a, b) => a - b);
                
                // Create finger mapping (1-4)
                const fingerMap = {};
                usedFrets.forEach((f, i) => {
                    fingerMap[f] = Math.min(i + 1, 4);
                });
                
                return fingerMap[fret] || '';
            }
        }

        // Utility Functions
        class FingerPatterns {
            constructor() {
                this.f = Array.from({ length: MAX_PATTERNS }, () => Array(MAX_STRINGS).fill(0));
                this.n = 0;
            }
        }

        class StringList {
            constructor() {
                this.f = Array(MAX_FRETS).fill(0);
                this.n = 0;
            }
        }

        function incNote(x, y) {
            const result = (x + y) % N_NOTES_IN_SCALE;
            return result >= 0 ? result : result + N_NOTES_IN_SCALE;
        }

        function letterOf(noteNum) {
            const letters = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];
            return letters[noteNum] || '?';
        }

        function getNoteNum(chStart, accidental = '') {
            const noteMap = { 'A': _A, 'B': _B, 'C': _C, 'D': _D, 'E': _E, 'F': _F, 'G': _G };
            let noteNum = noteMap[chStart.toUpperCase()] || _C;
            
            if (accidental === '#') noteNum += 1;
            else if (accidental === 'b') noteNum -= 1;
            
            return ((noteNum % N_NOTES_IN_SCALE) + N_NOTES_IN_SCALE) % N_NOTES_IN_SCALE;
        }

        function parseChordInput(input) {
            const chord = [];
            const parts = input.trim().toUpperCase().split(/\s+/);
            
            for (const part of parts) {
                if (part.length === 0) continue;
                
                const note = part[0];
                const accidental = part.slice(1);
                
                if ('ABCDEFG'.includes(note)) {
                    let acc = '';
                    if (accidental.includes('#')) acc = '#';
                    else if (accidental.includes('B')) acc = 'b';
                    
                    chord.push(getNoteNum(note, acc));
                }
            }
            
            const uniqueChord = [...new Set(chord)];
            return [uniqueChord, uniqueChord.length];
        }

        function inChord(note, chord, n) {
            return chord.slice(0, n).includes(note);
        }

        function isChord(ch1, n1, ch2, n2) {
            const sawNote = Array(n2).fill(false);
            
            for (let i = 0; i < n2; i++) {
                for (let j = 0; j < n1; j++) {
                    if (ch2[i] === ch1[j]) {
                        sawNote[i] = true;
                        break;
                    }
                }
            }
            
            return sawNote.every(x => x);
        }

        function buildPat(possible, chPatterns, chord, chLen, root) {
            const prefOrder = Array.from({ length: 4 }, () => Array(3).fill(0));
            
            for (const s of [LOW_E, A_STRING, D_STRING]) {
                let t = 0;
                let b = possible[s].n - 1;
                
                for (let f = 0; f < possible[s].n; f++) {
                    const j = possible[s].f[f];
                    if (j >= 0 && fretNotes[j] && fretNotes[j][s] === root) {
                        prefOrder[s][t] = j;
                        t++;
                    } else {
                        prefOrder[s][b] = j;
                        b--;
                    }
                }
            }
            
            let n = 0;
            const maxN = Math.min(MAX_PATTERNS, 20); // Limit to 20 patterns for better performance
            
            for (let le = 0; le < possible[LOW_E].n && n < maxN; le++) {
                for (let as = 0; as < possible[A_STRING].n && n < maxN; as++) {
                    for (let ds = 0; ds < possible[D_STRING].n && n < maxN; ds++) {
                        for (let gs = 0; gs < possible[G_STRING].n && n < maxN; gs++) {
                            for (let bs = 0; bs < possible[B_STRING].n && n < maxN; bs++) {
                                for (let he = 0; he < possible[HIGH_E].n && n < maxN; he++) {
                                    chPatterns.f[n][LOW_E] = prefOrder[LOW_E][le];
                                    chPatterns.f[n][A_STRING] = prefOrder[A_STRING][as];
                                    chPatterns.f[n][D_STRING] = prefOrder[D_STRING][ds];
                                    chPatterns.f[n][G_STRING] = possible[G_STRING].f[gs];
                                    chPatterns.f[n][B_STRING] = possible[B_STRING].f[bs];
                                    chPatterns.f[n][HIGH_E] = possible[HIGH_E].f[he];
                                    
                                    const thisChord = Array.from({ length: MAX_STRINGS }, (_, j) => {
                                        const fret = chPatterns.f[n][j];
                                        return fret >= 0 && fretNotes[fret] ? fretNotes[fret][j] : -1;
                                    });
                                    
                                    if (isChord(thisChord, MAX_STRINGS, chord, chLen)) {
                                        n++;
                                    }
                                }
                            }
                        }
                    }
                }
            }
            
            chPatterns.n = n;
        }

        function tune() {
            for (let i = 1; i < MAX_FRETS; i++) {
                for (let j = 0; j < MAX_STRINGS; j++) {
                    fretNotes[i][j] = incNote(fretNotes[i - 1][j], 1);
                }
            }
        }

        function generateChordFingerings(chord, chordLen, firstFret, fretRange, root) {
            alert('implement me');
        }
</script>
</div>
</html>
